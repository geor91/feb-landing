$(function(){$("[data-modal]").click(function(e){var a=$(this).data("modal");t.init(a)}),$(".js-anchor").click(function(t){t.preventDefault();var e=$(this).attr("href").slice(1),a=document.getElementById(e).offsetTop,i=$("header").outerHeight(),n=a-i;$("body,html").animate({scrollTop:n},600)}),$(window).scroll(function(){var t=$("header"),e=t.outerHeight(),a=$(window).scrollTop();a>2*e?t.addClass("fixed-header"):t.removeClass("fixed-header")});var t={init:function(t){this.targetId=t,this.targetHtml=$(t+"Tpl").html(),this.appendModal(),this.initEvents()},appendModal:function(){$("body").append(this.targetHtml)},removeModal:function(){$(this.targetId).remove()},initEvents:function(){$(this.targetId).modal("show"),$(this.targetId+" .inputmask").inputmask(),$(this.targetId).on("hidden.bs.modal",function(){t.removeModal()}),$(this.targetId+" form.js-ajax-form").on("submit",function(t){t.preventDefault();var e=$(this).parents(".ajax-form"),a=$(this).serializeArray(),i={};for(var n in a){var s=a[n];i[s.name]=s.value}$.ajax({url:"/taxi/public/statement?native=true",type:"POST",data:JSON.stringify(i),contentType:"application/json; charset=utf-8"}).done(function(){$(e).addClass("ajax-form_completed")}).fail(function(){alert("Проблемы с соединением. Заявка не была отправлена.")})})}};$("#getDLink").submit(function(t){t.preventDefault();var e=$(this),a=e.children("#sendSmsPhone"),i=e.children("#sendSmsBtn"),n=e.children(".app-get-sms__status"),s=a.inputmask("unmaskedvalue");if(s){if(10!=s.length)return i.attr("disabled","disabled"),n.addClass("alert-danger").text("Неверный формат.").show(),setTimeout(function(){n.removeClass("alert-danger").hide().text(""),i.removeAttr("disabled")},3e3),!1;var r="/taxi/rest/public/link/7"+s;$.ajax({url:r,type:"POST"}).done(function(){a.val(""),i.attr("disabled","disabled"),n.addClass("alert-success").text("Сообщение отправлено.").show(),setTimeout(function(){n.removeClass("alert-success").hide().text(""),i.removeAttr("disabled")},5e3)}).fail(function(){i.attr("disabled","disabled"),n.addClass("alert-danger").text("Сообщение не отправлено.").show(),setTimeout(function(){n.removeClass("alert-danger").hide().text(""),i.removeAttr("disabled")},2e3)})}})}),$(function(){$(".inputmask").inputmask()});